<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Door Delivery Memo - Advanced System</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }

        body {
            background-color: #f3f4f6;
        }

        /* Header Styles */
        .header {
            background-color: #e0f2fe;
            padding: 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .logo-section {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .logo-section img {
            height: 48px;
            border-radius: 4px;
        }

        .welcome-text .name {
            color: #059669;
            font-weight: 500;
        }

        .welcome-text .support {
            color: #dc2626;
            font-size: 0.875rem;
        }

        /* Navigation Styles */
        .nav {
            background-color: #1e3a8a;
            padding: 1rem;
            color: white;
        }

        .nav-container {
            max-width: 1280px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .nav-links a {
            color: white;
            text-decoration: none;
            margin-right: 1.5rem;
            padding: 0.5rem 1rem;
            border-radius: 0.375rem;
            transition: background-color 0.2s;
        }

        .nav-links a:hover {
            background-color: rgba(255,255,255,0.1);
        }

        /* Main Content Styles */
        .main-content {
            max-width: 1280px;
            margin: 2rem auto;
            padding: 0 1rem;
        }

        .search-section {
            background-color: white;
            border-radius: 0.5rem;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            padding: 1.5rem;
            margin-bottom: 2rem;
            width: 50%;
        }

        .search-title {
            color: #1e3a8a;
            font-size: 1.5rem;
            margin-bottom: 1.5rem;
            font-weight: 600;
        }

        .search-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .form-group label {
            font-weight: 500;
            color: #374151;
        }

        .form-group select,
        .form-group input {
            padding: 0.625rem;
            border: 1px solid #d1d5db;
            border-radius: 0.375rem;
            font-size: 0.875rem;
            transition: border-color 0.2s;
        }

        .form-group select:focus,
        .form-group input:focus {
            outline: none;
            border-color: #2563eb;
            ring: 2px solid #93c5fd;
        }

        .search-btn {
            background-color: #2563eb;
            color: white;
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 0.375rem;
            cursor: pointer;
            font-weight: 500;
            transition: background-color 0.2s;
            width: fit-content;
        }

        .search-btn:hover {
            background-color: #1d4ed8;
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            z-index: 1000;
        }

        .modal-content {
            background-color: white;
            margin: 2rem auto;
            padding: 1.5rem;
            border-radius: 0.5rem;
            width: 95%;
            max-width: 1400px;
            max-height: 80vh;
            overflow-y: auto;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid #e5e7eb;
        }

        .modal-header h3 {
            color: #1e3a8a;
            font-size: 1.25rem;
        }

        .close {
            font-size: 1.5rem;
            cursor: pointer;
            color: #6b7280;
            transition: color 0.2s;
        }

        .close:hover {
            color: #1f2937;
        }

        /* Filter Section Styles */
        .filter-section {
            background-color: #f8fafc;
            padding: 1rem;
            margin-bottom: 1rem;
            border-radius: 0.375rem;
            border: 1px solid #e5e7eb;
        }

        .filter-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
        }

        /* Table Styles */
        .table-container {
            margin-top: 1.5rem;
            overflow-x: auto;
            background-color: white;
            border-radius: 0.5rem;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.875rem;
        }

        .data-table th,
        .data-table td {
            padding: 0.75rem;
            border: 1px solid #e5e7eb;
            text-align: left;
        }

        .data-table th {
            background-color: #f3f4f6;
            font-weight: 600;
            color: #374151;
            white-space: nowrap;
        }

        .data-table tbody tr:nth-child(even) {
            background-color: #f9fafb;
        }

        .data-table tbody tr:hover {
            background-color: #f3f4f6;
        }

        /* Loading Details Styles */
        .loading-details {
            background-color: #f8fafc;
            padding: 1.5rem;
            border-radius: 0.5rem;
            margin: 1.5rem 0;
            border: 1px solid #e5e7eb;
        }

        .loading-details h3 {
            color: #1e3a8a;
            margin-bottom: 1rem;
            font-size: 1.125rem;
        }

        .loading-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
        }

        /* Action Buttons */
        .action-buttons {
            display: flex;
            gap: 1rem;
            margin: 1rem 0;
        }

        .action-btn {
            padding: 0.625rem 1.25rem;
            border: none;
            border-radius: 0.375rem;
            cursor: pointer;
            font-weight: 500;
            transition: background-color 0.2s;
        }

        .remove-btn {
            background-color: #ef4444;
            color: white;
        }

        .remove-btn:hover {
            background-color: #dc2626;
        }

        .delivery-btn {
            background-color: #10b981;
            color: white;
        }

        .delivery-btn:hover {
            background-color: #059669;
        }

        /* Print Styles */
        @media print {
            .no-print {
                display: none;
            }
            
            .print-only {
                display: block;
            }

            .modal-content {
                margin: 0;
                padding: 0;
            }

            .data-table {
                page-break-inside: auto;
            }

            .data-table tr {
                page-break-inside: avoid;
                page-break-after: auto;
            }
        }
    </style>
</head>
<body>

    <main class="main-content">
        <section class="search-section">
            <h2 class="search-title">Door Delivery Memo</h2>
            <form id="searchForm">
                <div class="search-grid">
                    <div class="form-group">
                        <label for="destination">Destination</label>
                        <select id="destination" required>
                            <option value="">-- ALL --</option>
                            <option value="NAGPUR">NAGPUR</option>
                            <option value="MUMBAI">MUMBAI</option>
                            <option value="DELHI">DELHI</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="deliveryFor">Delivery For</label>
                        <select id="deliveryFor" required>
                            <option value="BOTH">BOTH</option>
                            <option value="LOCAL">LOCAL</option>
                            <option value="OUTSTATION">OUTSTATION</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label for="lrNumber">Search By LR No.</label>
                    <input type="text" id="lrNumber" placeholder="Enter LR Number">
                </div>
                <button type="submit" class="search-btn">Search</button>
            </form>
        </section>

        <section id="selectedCNotes" style="display: none;">
            <div class="action-buttons">
                <button class="action-btn remove-btn" id="removeSelected">Remove LR</button>
                <button class="action-btn delivery-btn" id="doorDelivery">Door Delivery</button>
            </div>

            <div class="loading-details">
                <h3>Loading Details</h3>
                <div class="loading-grid">
                    <div class="form-group">
                        <label for="truckNo">Truck No.</label>
                        <input type="text" id="truckNo" required>
                    </div>
                    <div class="form-group">
                        <label for="driverName">Driver Name</label>
                        <input type="text" id="driverName" required>
                    </div>
                    <div class="form-group">
                        <label for="driverNo">Driver No.</label>
                        <input type="text" id="driverNo" required>
                    </div>
                    <div class="form-group">
                        <label for="lorryHire">Lorry Hire</label>
                        <input type="number" id="lorryHire" required>
                    </div>
                    <div class="form-group">
                        <label for="remarks">Remarks</label>
                        <input type="text" id="remarks">
                    </div>
                </div>
            </div>

            <div class="table-container">
                <table class="data-table">
                    <thead>
                        <tr>
                            <th><input type="checkbox" id="selectAll"></th>
                            <th>LR No.</th>
                            <th>From</th>
                            <th>To</th>
                            <th>Packages</th>
                            <th>Weight</th>
                            <th>Value</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody id="selectedTableBody"></tbody>
                </table>
            </div>
        </section>
    </main>

    <!-- Modal for CNotes Selection -->
    <div id="cnotesModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Searched Details</h3>
                <span class="close">&times;</span>
            </div>

            <div class="filter-section">
                <div class="filter-grid">
                    <div class="form-group">
                        <label for="filterDate">Date</label>
                        <input type="date" id="filterDate">
                    </div>
                    <div class="form-group">
                        <label for="filterLRNo">LR No.</label>
                        <input type="text" id="filterLRNo" placeholder="Filter by LR No.">
                    </div>
                    <div class="form-group">
                        <label for="filterFrom">From</label>
                        <select id="filterFrom">
                            <option value="">All</option>
                            <option value="AKOLA MIDC">AKOLA MIDC</option>
                            <option value="AMRAVATI">AMRAVATI</option>
                            <option value="BHAISTHAN">BHAISTHAN</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="filterTo">To</label>
                        <select id="filterTo">
                            <option value="">All</option>
                            <option value="NAGPUR">NAGPUR</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="filterArt">Art</label>
                        <input type="number" id="filterArt" placeholder="Filter by Art">
                    </div>
                    <div class="form-group">
                        <label for="filterWeight">Weight</label>
                        <input type="number" id="filterWeight" placeholder="Filter by Weight">
                    </div>
                </div>
            </div>

            <div class="table-container">
                <table class="data-table">
                    <thead>
                        <tr>
                            <th><input type="checkbox" id="modalSelectAll"></th>
                            <th>Upload DL</th>
                            <th>LR No.</th>
                            <th>From</th>
                            <th>To</th>
                            <th>Art</th>
                            <th>Weight</th>
                            <th>Grand Total</th>
                            <th>Delivery To</th>
                            <th>Cong'or</th>
                            <th>Cong'ee</th>
                            <th>LR Type</th>
                        </tr>
                    </thead>
                    <tbody id="modalTableBody"></tbody>
                </table>
            </div>
            <div style="margin-top: 1rem; text-align: right;">
                <button class="action-btn delivery-btn" id="addSelected">Add Selected</button>
            </div>
        </div>
    </div>

    <script>
        // Sample CNotes data
        const sampleCNotes = [
            {
                id: 1,
                uploadDL: '21-06-2024',
                lrNo: 'MIDC-3696',
                from: 'AKOLA MIDC',
                to: 'NAGPUR',
                art: 9,
                weight: 90,
                grandTotal: 720,
                deliveryTo: 'Door Dly',
                congor: 'PARSHUNATH ENTERPRISES',
                congee: 'RAKESH GODWANI',
                lrType: 'TO PAY',
                status: 'Pending'
            },
            {
                id: 2,
                uploadDL: '21-06-2024',
                lrNo: 'AMT-5027',
                from: 'AMRAVATI',
                to: 'NAGPUR',
                art: 1,
                weight: 10,
                grandTotal: 80,
                deliveryTo: 'Door Dly',
                congor: 'D T L SPORTS',
                congee: 'TAILOR BARD',
                lrType: 'TO PAY',
                status: 'Pending'
            },
            {
                id: 3,
                uploadDL: '21-06-2024',
                lrNo: 'BHST-1564',
                from: 'BHAISTHAN',
                to: 'NAGPUR',
                art: 1,
                weight: 0,
                grandTotal: 100,
                deliveryTo: 'Door Dly',
                congor: 'SANJAY COMPUTERS',
                congee: 'KUMAR SYSTEMS',
                lrType: 'TO PAY',
                status: 'Pending'
            }
        ];

        let selectedCNotes = [];

        // Update datetime
        function updateDateTime() {
            const now = new Date();
            document.getElementById('datetime').textContent = 
                `${now.toLocaleString()} • Contact Support`;
        }
        setInterval(updateDateTime, 1000);
        updateDateTime();

        // Search form submission
        document.getElementById('searchForm').addEventListener('submit', (e) => {
            e.preventDefault();
            document.getElementById('cnotesModal').style.display = 'block';
            displayModalCNotes();
        });

        // Modal close button
        document.querySelector('.close').addEventListener('click', () => {
            document.getElementById('cnotesModal').style.display = 'none';
        });

        // Close modal when clicking outside
        window.addEventListener('click', (e) => {
            const modal = document.getElementById('cnotesModal');
            if (e.target === modal) {
                modal.style.display = 'none';
            }
        });

        // Display modal CNotes
        function displayModalCNotes() {
            const modalTableBody = document.getElementById('modalTableBody');
            modalTableBody.innerHTML = sampleCNotes.map(cnote => `
                <tr>
                    <td><input type="checkbox" value="${cnote.id}"></td>
                    <td>${cnote.uploadDL}</td>
                    <td>${cnote.lrNo}</td>
                    <td>${cnote.from}</td>
                    <td>${cnote.to}</td>
                    <td>${cnote.art}</td>
                    <td>${cnote.weight}</td>
                    <td>${cnote.grandTotal}</td>
                    <td>${cnote.deliveryTo}</td>
                    <td>${cnote.congor}</td>
                    <td>${cnote.congee}</td>
                    <td>${cnote.lrType}</td>
                </tr>
            `).join('');
        }

        // Filter functionality
        const filterInputs = ['filterDate', 'filterLRNo', 'filterFrom', 'filterTo', 'filterArt', 'filterWeight'];
        filterInputs.forEach(id => {
            document.getElementById(id).addEventListener('input', filterCNotes);
        });

        function filterCNotes() {
            const filters = {
                date: document.getElementById('filterDate').value,
                lrNo: document.getElementById('filterLRNo').value.toLowerCase(),
                from: document.getElementById('filterFrom').value.toLowerCase(),
                to: document.getElementById('filterTo').value.toLowerCase(),
                art: document.getElementById('filterArt').value,
                weight: document.getElementById('filterWeight').value
            };

            const filteredData = sampleCNotes.filter(cnote => {
                return (!filters.date || cnote.uploadDL.includes(filters.date)) &&
                       (!filters.lrNo || cnote.lrNo.toLowerCase().includes(filters.lrNo)) &&
                       (!filters.from || cnote.from.toLowerCase().includes(filters.from)) &&
                       (!filters.to || cnote.to.toLowerCase().includes(filters.to)) &&
                       (!filters.art || cnote.art === parseInt(filters.art)) &&
                       (!filters.weight || cnote.weight === parseInt(filters.weight));
            });

            const modalTableBody = document.getElementById('modalTableBody');
            modalTableBody.innerHTML = filteredData.map(cnote => `
                <tr>
                    <td><input type="checkbox" value="${cnote.id}"></td>
                    <td>${cnote.uploadDL}</td>
                    <td>${cnote.lrNo}</td>
                    <td>${cnote.from}</td>
                    <td>${cnote.to}</td>
                    <td>${cnote.art}</td>
                    <td>${cnote.weight}</td>
                    <td>${cnote.grandTotal}</td>
                    <td>${cnote.deliveryTo}</td>
                    <td>${cnote.congor}</td>
                    <td>${cnote.congee}</td>
                    <td>${cnote.lrType}</td>
                </tr>
            `).join('');
        }

        // Modal select all functionality
        document.getElementById('modalSelectAll').addEventListener('change', (e) => {
            const checkboxes = document.querySelectorAll('#modalTableBody input[type="checkbox"]');
            checkboxes.forEach(cb => cb.checked = e.target.checked);
        });

        // Add selected CNotes
        document.getElementById('addSelected').addEventListener('click', () => {
            const checkboxes = document.querySelectorAll('#modalTableBody input[type="checkbox"]:checked');
            const selectedIds = Array.from(checkboxes).map(cb => parseInt(cb.value));
            
            const newSelectedCNotes = sampleCNotes.filter(cnote => 
                selectedIds.includes(cnote.id) && 
                !selectedCNotes.find(selected => selected.id === cnote.id)
            );
            
            selectedCNotes = [...selectedCNotes, ...newSelectedCNotes];
            updateSelectedTable();
            document.getElementById('cnotesModal').style.display = 'none';
            document.getElementById('selectedCNotes').style.display = 'block';
        });

        // Update selected CNotes table
        function updateSelectedTable() {
            const selectedTableBody = document.getElementById('selectedTableBody');
            selectedTableBody.innerHTML = selectedCNotes.map(cnote => `
                <tr>
                    <td><input type="checkbox" value="${cnote.id}"></td>
                    <td>${cnote.lrNo}</td>
                    <td>${cnote.from}</td>
                    <td>${cnote.to}</td>
                    <td>${cnote.art}</td>
                    <td>${cnote.weight}</td>
                    <td>${cnote.grandTotal}</td>
                    <td>${cnote.status}</td>
                </tr>
            `).join('');
        }

        // Select all functionality for selected table
        document.getElementById('selectAll').addEventListener('change', (e) => {
            const checkboxes = document.querySelectorAll('#selectedTableBody input[type="checkbox"]');
            checkboxes.forEach(cb => cb.checked = e.target.checked);
        });

        // Remove selected CNotes
        document.getElementById('removeSelected').addEventListener('click', () => {
            const checkboxes = document.querySelectorAll('#selectedTableBody input[type="checkbox"]:checked');
            const removeIds = Array.from(checkboxes).map(cb => parseInt(cb.value));
            selectedCNotes = selectedCNotes.filter(cnote => !removeIds.includes(cnote.id));
            updateSelectedTable();
        });

        // Door Delivery functionality
        document.getElementById('doorDelivery').addEventListener('click', () => {
            const loadingDetails = {
                truckNo: document.getElementById('truckNo').value,
                driverName: document.getElementById('driverName').value,
                driverNo: document.getElementById('driverNo').value,
                lorryHire: document.getElementById('lorryHire').value,
                remarks: document.getElementById('remarks').value
            };

            // Validate loading details
            if (!loadingDetails.truckNo || !loadingDetails.driverName || 
                !loadingDetails.driverNo || !loadingDetails.lorryHire) {
                alert('Please fill in all required loading details');
                return;
            }

            // Create print window
            const printWindow = window.open('', '_blank');
            printWindow.document.write(`
                <!DOCTYPE html>
                <html>
                <head>
                    <title>Door Delivery Memo - Print</title>
                    <style>
                        body { 
                            font-family: Arial, sans-serif;
                            padding: 20px;
                        }
                        table { 
                            width: 100%;
                            border-collapse: collapse;
                            margin: 1rem 0;
                        }
                        th, td { 
                            border: 1px solid #000;
                            padding: 8px;
                            text-align: left;
                        }
                        .loading-details { 
                            margin-bottom: 1rem;
                        }
                        .signature-line {
                            margin-top: 2rem;
                            border-top: 1px solid #000;
                            padding-top: 0.5rem;
                        }
                        @media print {
                            body { 
                                padding: 0;
                            }
                        }
                    </style>
                </head>
                <body>
                    <h2>Door Delivery Memo</h2>
                    <div class="loading-details">
                        <h3>Loading Details</h3>
                        <p><strong>Truck No:</strong> ${loadingDetails.truckNo}</p>
                        <p><strong>Driver Name:</strong> ${loadingDetails.driverName}</p>
                        <p><strong>Driver No:</strong> ${loadingDetails.driverNo}</p>
                        <p><strong>Lorry Hire:</strong> ${loadingDetails.lorryHire}</p>
                        <p><strong>Remarks:</strong> ${loadingDetails.remarks}</p>
                    </div>
                    <table>
                        <thead>
                            <tr>
                                <th>LR No.</th>
                                <th>From</th>
                                <th>To</th>
                                <th>Packages</th>
                                <th>Weight</th>
                                <th>Value</th>
                                <th>Sign & Stamp</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${selectedCNotes.map(cnote => `
                                <tr>
                                    <td>${cnote.lrNo}</td>
                                    <td>${cnote.from}</td>
                                    <td>${cnote.to}</td>
                                    <td>${cnote.art}</td>
                                    <td>${cnote.weight}</td>
                                    <td>${cnote.grandTotal}</td>
                                    <td></td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                    <div class="signature-line">
                        <p>Authorized Signature</p>
                    </div>
                </body>
                </html>
            `);
            printWindow.document.close();
            printWindow.print();
        });
    </script>
</body>
</html>